/*!
 * plyr-helper v1.0.1
 * A lightweight helper package that enhances video embedding using the Plyr.io media player
 * (c) 2025 Druhin Tarafder
 * Released under the MIT License
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=[];function t(e,t,o=!1){if(!e.hasAttribute(t))return o;const n=e.getAttribute(t);return""===n||n===t||"true"===n}function o(e,t,o=null){if(!e.hasAttribute(t))return o;const n=e.getAttribute(t);return""!==n?n:o}function n(e){if(e.includes("youtu.be/"))return e.split("youtu.be/")[1].split(/[?&#]/)[0];var t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);return t?t[1]:null}function i(e){var t=e.match(/(?:vimeo\.com\/(?:video\/|channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|)(\d+)(?:$|\/|\?))/);return t?t[1]:null}var r,a,l;function d(){if("undefined"==typeof Plyr)return void console.error("Plyr library not loaded properly");var r=[],a=document.createElement("style");a.textContent='\n      .dt-video-container {\n        position: relative !important;\n        overflow: hidden !important;\n      }\n      \n      /* Base Plyr elements */\n      .dt-video-container .plyr {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n      }\n      \n      /* Video embed containers */\n      .dt-video-container .plyr__video-embed,\n      .dt-video-container .plyr__video-wrapper {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        overflow: hidden !important;\n      }\n      \n      /* YouTube and Vimeo iframe scaling */\n      .dt-video-container .plyr__video-embed iframe {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) scale(var(--plyr-video-scale, 1.0)) !important;\n        width: 100% !important;\n        height: 100% !important;\n      }\n      \n      /* HTML5 video scaling for direct video files */\n      .dt-video-container video,\n      .dt-video-container .plyr__video-wrapper video,\n      .dt-video-container .plyr--video video {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        object-fit: cover !important;\n        object-position: center !important;\n      }\n      \n      /* Controls should be visible */\n      .dt-video-container .plyr__controls {\n        z-index: 10 !important;\n      }\n      \n      .dt-video-container .plyr__control--overlaid {\n        z-index: 10 !important;\n      }\n      \n      /* Fix for poster/thumbnail to use object-fit: cover */\n      .dt-video-container .plyr__poster {\n        background-size: cover !important;\n        background-position: center center !important;\n        opacity: 1 !important;\n      }\n      \n      /* Hide poster when video is playing in autoplay mode */\n      .dt-video-container.autoplay-active .plyr__poster,\n      .dt-video-container.autoplay-active .custom-poster {\n        display: none !important;\n      }\n      \n      /* Custom poster styling */\n      .custom-poster {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        background-size: cover !important;\n        background-position: center center !important;\n        z-index: 1 !important;\n      }\n      \n      /* Lazy loading container */\n      .dt-video-lazy-container {\n        position: relative;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      \n      .dt-video-lazy-placeholder {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        cursor: pointer;\n      }\n      \n      .dt-video-lazy-placeholder::before {\n        content: "";\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0,0,0,0.2);\n        opacity: 0;\n        transition: opacity 0.3s;\n      }\n      \n      .dt-video-lazy-placeholder:hover::before {\n        opacity: 1;\n      }\n      \n      .dt-video-lazy-placeholder .lazy-play-button {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 80px;\n        height: 80px;\n        background-color: rgba(0,0,0,0.7);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: transform 0.3s, background-color 0.3s;\n        z-index: 2;\n      }\n      \n      .dt-video-lazy-placeholder:hover .lazy-play-button {\n        transform: translate(-50%, -50%) scale(1.1);\n        background-color: var(--plyr-color-main, rgba(0,0,0,0.8));\n      }\n      \n      .dt-video-lazy-placeholder .lazy-play-button::after {\n        content: "";\n        width: 0;\n        height: 0;\n        border-top: 15px solid transparent;\n        border-bottom: 15px solid transparent;\n        border-left: 25px solid white;\n        margin-left: 5px;\n      }\n    ',document.head.appendChild(a);const l=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const o=t.target,n=parseInt(o.dataset.videoIndex,10);if(!isNaN(n)&&e[n]){const t=e[n];d(t.img,t.wrapper,t.referenceImg),e[n]=null,l.unobserve(o)}}}))}),{root:null,rootMargin:"200px",threshold:0});function d(e,a,l){var d=o(e,"data-dt-video-url","https://youtu.be/ivzDSDsOEOI"),s=t(e,"data-dt-video-controls"),p=t(e,"data-dt-video-mute"),c=parseFloat(e.getAttribute("data-dt-video-playback-rate"))||1,u=t(e,"data-dt-video-loop"),y=e.getAttribute("src"),m=t(e,"data-dt-video-autoplay"),v=o(e,"data-dt-video-theme-color","#131313"),h=e.getAttribute("data-dt-video-custom-controls"),b=parseFloat(e.getAttribute("data-dt-video-start-time"))||0,f=e.hasAttribute("data-dt-video-end-time")&&""===e.getAttribute("data-dt-video-end-time"),g=parseFloat(e.getAttribute("data-dt-video-end-time"))||0,w=e.getAttribute("data-dt-video-quality")||"default",_=t(e,"data-dt-video-pause-on-blur"),x=t(e,"data-dt-video-play-on-hover");m&&(p=!0);var E=function(e){if(!e)return null;const t=["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen","restart","fast-forward"];return e.split(",").map((e=>e.trim())).filter((e=>t.includes(e)))}(h);if(v){var k,C="plyr-theme-"+Math.random().toString(36).substring(2,9),z=document.createElement("style");z.id=C;try{k=function(e){let t,o,n;return 3===(e=e.replace(/^#/,"")).length?(t=parseInt(e[0]+e[0],16),o=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16)):(t=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16)),{r:t,g:o,b:n}}(v.replace("#",""))}catch(e){k={r:19,g:19,b:19}}z.textContent=`\n          .${C} .plyr__control--overlaid,\n          .${C} .plyr--video .plyr__control.plyr__tab-focus,\n          .${C} .plyr--video .plyr__control:hover,\n          .${C} .plyr--video .plyr__control[aria-expanded=true],\n          .${C} .plyr--audio .plyr__control.plyr__tab-focus,\n          .${C} .plyr--audio .plyr__control:hover,\n          .${C} .plyr--audio .plyr__control[aria-expanded=true] {\n            background: ${v} !important;\n          }\n\n          .${C} .plyr--full-ui input[type=range] {\n            color: ${v} !important;\n          }\n\n          .${C} .plyr__control--overlaid:hover {\n            background: rgba(${k.r}, ${k.g}, ${k.b}, 0.85) !important;\n          }\n\n          .${C} .plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::before {\n            background: ${v} !important;\n          }\n        `,document.head.appendChild(z),a.classList.add(C)}var R=function(e){return e?e.includes("youtube.com")||e.includes("youtu.be")?{type:"youtube",id:n(e)}:e.includes("vimeo.com")?{type:"vimeo",id:i(e)}:e.match(/\.(mp4|webm|ogg|mov)($|\?)/i)?{type:"video",id:e}:{type:null,id:null}:{type:null,id:null}}(d);if(R.type&&R.id){var A,S,T=a.querySelector(".dt-video-lazy-placeholder");if(T&&a.removeChild(T),"youtube"===R.type||"vimeo"===R.type){(A=document.createElement("div")).className="plyr__video-embed";var I=document.createElement("iframe");if("youtube"===R.type){var $=`https://www.youtube.com/embed/${R.id}?origin=${encodeURIComponent(window.location.origin)}&enablejsapi=1&widgetid=1&modestbranding=1&playsinline=1&showinfo=0&rel=0&iv_load_policy=3&fs=0&autohide=0`;b>0&&($+=`&start=${Math.floor(b)}`),g>0&&($+=`&end=${Math.floor(g)}`),m&&($+="&autoplay=1&mute=1"),I.src=$}else{var q=`https://player.vimeo.com/video/${R.id}?byline=0&portrait=0&title=0`;b>0&&(q+=`#t=${b}s`),m&&(q+="&autoplay=1&muted=1"),I.src=q}I.allowFullscreen=!0,I.allow="autoplay; fullscreen; picture-in-picture",A.appendChild(I),S=I}else{(A=document.createElement("div")).className="plyr__video-wrapper";var j=document.createElement("video");j.className="plyr__video",j.controls=s,j.muted=p,j.loop=u,j.autoplay=m,j.poster=y,j.playbackRate=c,j.playsInline=!0,b>0&&(j.currentTime=b),j.style.position="absolute",j.style.top="0",j.style.left="0",j.style.width="100%",j.style.height="100%",j.style.objectFit="cover",j.style.objectPosition="center";var P=document.createElement("source");P.src=R.id,P.type=function(e){switch(e.split(".").pop().split("?")[0].toLowerCase()){case"mp4":default:return"video/mp4";case"webm":return"video/webm";case"ogg":return"video/ogg";case"mov":return"video/quicktime"}}(R.id),j.appendChild(P),A.appendChild(j),S=j,A.style.width="100%",A.style.height="100%",A.style.position="absolute",A.style.top="0",A.style.left="0"}if(A.style.position="absolute",A.style.top="0",A.style.left="0",A.style.width="100%",A.style.height="100%",A.style.overflow="hidden",a.appendChild(A),y&&!m)(new Image).src=y;var L={controls:E||(s?["play-large","play","progress","current-time","mute","volume","captions","settings","fullscreen"]:[]),muted:p,autoplay:m,loop:{active:u},speed:{selected:c,options:[.5,.75,1,1.25,1.5,1.75,2]},poster:m?null:y,clickToPlay:!m,resetOnEnd:!!u};"youtube"===R.type?L.youtube={noCookie:!1,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,autoplay:m?1:0,start:b>0?Math.floor(b):0,end:g>0?Math.floor(g):void 0}:"vimeo"===R.type&&(L.vimeo={byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,autoplay:m?1:0});var N=new Plyr(A,L);if(r.push({player:N,wrapper:a,referenceImg:l,autoplay:m,videoElement:S,videoType:R.type,startTime:b,endTime:g,hasEmptyEndTime:f,quality:w}),N.once("ready",(function(){var e;if(N.speed=c,e=window.getComputedStyle(l).borderRadius,a.querySelectorAll(".plyr, .plyr__video-wrapper, .plyr__video-embed, .plyr--video, .plyr__poster, video").forEach((function(t){t.style.borderRadius=e})),m||M(),F(),("default"!==w&&"youtube"===R.type||"default"!==w&&"vimeo"===R.type)&&(N.quality=w),"video"===R.type&&b>0&&(N.currentTime=b),"video"===R.type&&(g>0||f)&&(f&&(g=N.duration||0),g>0&&N.on("timeupdate",(function(){N.currentTime>=g&&(u?(N.currentTime=b,N.play()):N.pause())}))),"youtube"===R.type&&f&&N.embed&&"function"==typeof N.embed.getDuration)try{setTimeout((()=>{const e=N.embed.getDuration();if(e){N.config.youtube.end=Math.floor(e),g=e;const t=N.currentTime;N.source={type:"video",sources:[{src:d,provider:"youtube"}]},N.on("ready",(()=>{N.currentTime=t,N.paused||N.play()}))}}),1e3)}catch(e){console.warn("Could not get YouTube video duration:",e)}if("vimeo"===R.type&&f&&N.embed&&"function"==typeof N.embed.getDuration)try{setTimeout((()=>{N.embed.getDuration().then((e=>{e&&(g=e,N.on("timeupdate",(function(){N.currentTime>=g&&(u?(N.currentTime=b,N.play()):N.pause())})))}))}),1e3)}catch(e){console.warn("Could not get Vimeo video duration:",e)}if("video"===R.type){const e=a.querySelector("video");e&&(e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center")}m?N.play().catch((function(e){console.warn("Autoplay was prevented by browser. Attempting muted autoplay.",e),N.muted=!0,N.play().catch((function(e){console.error("Autoplay was blocked even with muted audio:",e)}))})):(M(),function(){if(y){var e=a.querySelector(".plyr"),t=a.querySelector(".plyr__poster");if(!t||"none"===getComputedStyle(t).backgroundImage){t&&t.parentNode.removeChild(t);var o=document.createElement("div");o.className="plyr__poster custom-poster",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundImage=`url(${y})`,o.style.backgroundSize="cover",o.style.backgroundPosition="center center",o.style.borderRadius=a.style.borderRadius,o.style.zIndex="1",e&&(e.appendChild(o),e.addEventListener("play",(function(){o.style.display="none"})))}}}())})),m&&N.once("playing",(function(){a.classList.add("autoplay-active")})),x){let e;a.addEventListener("mouseenter",(function(){e=setTimeout((()=>{N.play().catch((function(e){N.muted=!0,N.play()}))}),200)})),a.addEventListener("mouseleave",(function(){clearTimeout(e),m||N.pause()}))}_&&document.addEventListener("visibilitychange",(function(){document.hidden?N.pause():m&&N.play()})),N.on("loadedmetadata",F),"video"===R.type&&N.on("ready canplay playing loadeddata",(function(){const e=a.querySelector("video");if(e){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center";const t=a.querySelector(".plyr__video-wrapper");t&&(t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0"),f&&e.duration&&(g=e.duration,N.on("timeupdate",(function(){N.currentTime>=g&&(u?(N.currentTime=b,N.play()):N.pause())})))}}))}else console.error("Unsupported video URL or could not extract video ID:",d);function F(){if("video"===R.type){const e=a.querySelector("video");return void(e&&(e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center"))}const e=16/9,t=a.offsetWidth,o=a.offsetHeight;if(0===t||0===o)return;const n=t/o;let i;i=n>e?n/e:e/n,a.style.setProperty("--plyr-video-scale",Math.max(1,i));const r=a.querySelector("iframe");r&&(n>e?(r.style.width="100%",r.style.height=100*i+"%"):(r.style.width=100*i+"%",r.style.height="100%"))}function M(){var e=a.querySelector(".plyr__poster");e&&(e.style.backgroundSize="cover",e.style.backgroundPosition="center center",e.style.opacity="1",e.style.width="100%",e.style.height="100%",e.style.borderRadius=a.style.borderRadius,e.style.zIndex="1")}}function s(){r.forEach((function(e){if(e){var t=window.getComputedStyle(e.referenceImg),o=e.wrapper;if(o.style.width=t.width,o.style.height=t.height,o.style.maxWidth=t.maxWidth,o.style.maxHeight=t.maxHeight,o.style.borderRadius=t.borderRadius,t.aspectRatio&&"auto"!==t.aspectRatio&&(o.style.aspectRatio=t.aspectRatio),o.querySelectorAll(".plyr, .plyr__video-wrapper, .plyr__video-embed, .plyr--video, .plyr__poster, .custom-poster, video").forEach((function(e){e.style.borderRadius=t.borderRadius})),!e.autoplay){var n=o.querySelector(".plyr__poster");n&&(n.style.borderRadius=t.borderRadius);var i=o.querySelector(".custom-poster");i&&(i.style.borderRadius=t.borderRadius)}if("video"!==e.videoType){if("youtube"===e.videoType||"vimeo"===e.videoType){const e=16/9,t=o.offsetWidth,n=o.offsetHeight;if(0===t||0===n)return;const i=t/n;let r;r=i>e?i/e:e/i,o.style.setProperty("--plyr-video-scale",Math.max(1,r));const a=o.querySelector("iframe");a&&(i>e?(a.style.width="100%",a.style.height=100*r+"%"):(a.style.width=100*r+"%",a.style.height="100%"))}}else{const e=o.querySelector("video");if(e){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center";const t=o.querySelector(".plyr__video-wrapper");t&&(t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0")}}}}))}let p;document.querySelectorAll('img[data-dt-video="true"]').forEach((function(n,i){o(n,"data-dt-video-url","https://youtu.be/ivzDSDsOEOI"),t(n,"data-dt-video-controls"),t(n,"data-dt-video-mute"),parseFloat(n.getAttribute("data-dt-video-playback-rate")),t(n,"data-dt-video-loop");var r=n.getAttribute("src"),a=t(n,"data-dt-video-autoplay"),s=o(n,"data-dt-video-theme-color","#131313");n.getAttribute("data-dt-video-custom-controls"),parseFloat(n.getAttribute("data-dt-video-start-time")),n.hasAttribute("data-dt-video-end-time")&&n.getAttribute("data-dt-video-end-time"),parseFloat(n.getAttribute("data-dt-video-end-time")),n.getAttribute("data-dt-video-quality"),t(n,"data-dt-video-pause-on-blur"),t(n,"data-dt-video-play-on-hover");var p=t(n,"data-dt-video-lazy-load"),c=document.createElement("div"),u=n.className;c.className=u+" dt-video-container"+(a?" autoplay-active":""),Array.from(n.attributes).forEach((function(e){"class"===e.name||e.name.startsWith("data-dt-video")||"src"===e.name||"loading"===e.name||"alt"===e.name||c.setAttribute(e.name,e.value)}));var y=n.cloneNode(!0);document.body.appendChild(y),y.style.position="absolute",y.style.opacity="0",y.style.pointerEvents="none",y.style.left="-9999px";var m=window.getComputedStyle(n);if(c.style.width=m.width,c.style.height=m.height,c.style.maxWidth=m.maxWidth,c.style.maxHeight=m.maxHeight,c.style.borderRadius=m.borderRadius,m.aspectRatio&&"auto"!==m.aspectRatio&&(c.style.aspectRatio=m.aspectRatio),p){var v=document.createElement("div");v.className="dt-video-lazy-placeholder",v.style.borderRadius=m.borderRadius,v.style.backgroundImage=`url(${r})`,v.style.backgroundSize="cover",v.style.backgroundPosition="center";var h=document.createElement("div");h.className="lazy-play-button",s&&h.style.setProperty("--plyr-color-main",s),v.appendChild(h),c.appendChild(v),e[i]={img:n,wrapper:c,referenceImg:y},c.dataset.videoIndex=i,v.addEventListener("click",(function(){e[i]&&(d(n,c,y),e[i]=null,l.unobserve(c))})),n.parentNode.replaceChild(c,n),l.observe(c)}else d(n,c,y),n.parentNode.replaceChild(c,n)})),s(),window.addEventListener("resize",(function(){clearTimeout(p),p=setTimeout(s,100)}));[window.matchMedia("(max-width: 991px)"),window.matchMedia("(max-width: 479px)")].forEach((function(e){e.addEventListener("change",s)}))}r="https://cdn.plyr.io/3.7.8/plyr.css",a=function(){var e,t,o;e="https://cdn.plyr.io/3.7.8/plyr.js",t=d,(o=document.createElement("script")).src=e,o.onload=t,document.head.appendChild(o)},(l=document.createElement("link")).rel="stylesheet",l.href=r,l.onload=a||function(){},document.head.appendChild(l)}))}));
