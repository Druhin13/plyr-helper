/*!
 * plyr-helper v1.0.0
 * A lightweight helper package that enhances video embedding using the Plyr.io media player
 * (c) 2025 Druhin Tarafder
 * Released under the MIT License
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=[];function t(e){if(e.includes("youtu.be/"))return e.split("youtu.be/")[1].split(/[?&#]/)[0];var t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);return t?t[1]:null}function o(e){var t=e.match(/(?:vimeo\.com\/(?:video\/|channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|)(\d+)(?:$|\/|\?))/);return t?t[1]:null}var n,i,r;function a(){if("undefined"==typeof Plyr)return void console.error("Plyr library not loaded properly");var n=[],i=document.createElement("style");i.textContent='\n      .dt-video-container {\n        position: relative !important;\n        overflow: hidden !important;\n      }\n      \n      /* Base Plyr elements */\n      .dt-video-container .plyr {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n      }\n      \n      /* Video embed containers */\n      .dt-video-container .plyr__video-embed,\n      .dt-video-container .plyr__video-wrapper {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        overflow: hidden !important;\n      }\n      \n      /* YouTube and Vimeo iframe scaling */\n      .dt-video-container .plyr__video-embed iframe {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) scale(var(--plyr-video-scale, 1.0)) !important;\n        width: 100% !important;\n        height: 100% !important;\n      }\n      \n      /* HTML5 video scaling for direct video files */\n      .dt-video-container video,\n      .dt-video-container .plyr__video-wrapper video,\n      .dt-video-container .plyr--video video {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        object-fit: cover !important;\n        object-position: center !important;\n      }\n      \n      /* Controls should be visible */\n      .dt-video-container .plyr__controls {\n        z-index: 10 !important;\n      }\n      \n      .dt-video-container .plyr__control--overlaid {\n        z-index: 10 !important;\n      }\n      \n      /* Fix for poster/thumbnail to use object-fit: cover */\n      .dt-video-container .plyr__poster {\n        background-size: cover !important;\n        background-position: center center !important;\n        opacity: 1 !important;\n      }\n      \n      /* Hide poster when video is playing in autoplay mode */\n      .dt-video-container.autoplay-active .plyr__poster,\n      .dt-video-container.autoplay-active .custom-poster {\n        display: none !important;\n      }\n      \n      /* Custom poster styling */\n      .custom-poster {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        background-size: cover !important;\n        background-position: center center !important;\n        z-index: 1 !important;\n      }\n      \n      /* Lazy loading container */\n      .dt-video-lazy-container {\n        position: relative;\n        overflow: hidden;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      \n      .dt-video-lazy-placeholder {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        cursor: pointer;\n      }\n      \n      .dt-video-lazy-placeholder::before {\n        content: "";\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0,0,0,0.2);\n        opacity: 0;\n        transition: opacity 0.3s;\n      }\n      \n      .dt-video-lazy-placeholder:hover::before {\n        opacity: 1;\n      }\n      \n      .dt-video-lazy-placeholder .lazy-play-button {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        width: 80px;\n        height: 80px;\n        background-color: rgba(0,0,0,0.7);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: transform 0.3s, background-color 0.3s;\n        z-index: 2;\n      }\n      \n      .dt-video-lazy-placeholder:hover .lazy-play-button {\n        transform: translate(-50%, -50%) scale(1.1);\n        background-color: var(--plyr-color-main, rgba(0,0,0,0.8));\n      }\n      \n      .dt-video-lazy-placeholder .lazy-play-button::after {\n        content: "";\n        width: 0;\n        height: 0;\n        border-top: 15px solid transparent;\n        border-bottom: 15px solid transparent;\n        border-left: 25px solid white;\n        margin-left: 5px;\n      }\n    ',document.head.appendChild(i);const r=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const o=t.target,n=parseInt(o.dataset.videoIndex,10);if(!isNaN(n)&&e[n]){const t=e[n];a(t.img,t.wrapper,t.referenceImg),e[n]=null,r.unobserve(o)}}}))}),{root:null,rootMargin:"200px",threshold:0});function a(e,i,r){var a=e.getAttribute("data-dt-video-url"),l="true"===e.getAttribute("data-dt-video-controls"),d="true"===e.getAttribute("data-dt-video-mute"),s=parseFloat(e.getAttribute("data-dt-video-playback-rate"))||1,p="true"===e.getAttribute("data-dt-video-loop"),c=e.getAttribute("src"),u="true"===e.getAttribute("data-dt-video-autoplay"),y=e.getAttribute("data-dt-video-theme-color"),m=e.getAttribute("data-dt-video-custom-controls"),v=parseFloat(e.getAttribute("data-dt-video-start-time"))||0,h=parseFloat(e.getAttribute("data-dt-video-end-time"))||0,b=e.getAttribute("data-dt-video-quality")||"default",f="true"===e.getAttribute("data-dt-video-pause-on-blur"),g="true"===e.getAttribute("data-dt-video-play-on-hover");u&&(d=!0);var w=function(e){if(!e)return null;const t=["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen","restart","fast-forward"];return e.split(",").map((e=>e.trim())).filter((e=>t.includes(e)))}(m);if(y){var _,x="plyr-theme-"+Math.random().toString(36).substring(2,9),A=document.createElement("style");A.id=x;try{_=function(e){let t,o,n;return 3===(e=e.replace(/^#/,"")).length?(t=parseInt(e[0]+e[0],16),o=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16)):(t=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16)),{r:t,g:o,b:n}}(y.replace("#",""))}catch(e){_={r:0,g:138,b:255}}A.textContent=`\n          .${x} .plyr__control--overlaid,\n          .${x} .plyr--video .plyr__control.plyr__tab-focus,\n          .${x} .plyr--video .plyr__control:hover,\n          .${x} .plyr--video .plyr__control[aria-expanded=true],\n          .${x} .plyr--audio .plyr__control.plyr__tab-focus,\n          .${x} .plyr--audio .plyr__control:hover,\n          .${x} .plyr--audio .plyr__control[aria-expanded=true] {\n            background: ${y} !important;\n          }\n\n          .${x} .plyr--full-ui input[type=range] {\n            color: ${y} !important;\n          }\n\n          .${x} .plyr__control--overlaid:hover {\n            background: rgba(${_.r}, ${_.g}, ${_.b}, 0.85) !important;\n          }\n\n          .${x} .plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::before {\n            background: ${y} !important;\n          }\n        `,document.head.appendChild(A),i.classList.add(x)}var E=function(e){return e?e.includes("youtube.com")||e.includes("youtu.be")?{type:"youtube",id:t(e)}:e.includes("vimeo.com")?{type:"vimeo",id:o(e)}:e.match(/\.(mp4|webm|ogg|mov)($|\?)/i)?{type:"video",id:e}:{type:null,id:null}:{type:null,id:null}}(a);if(E.type&&E.id){var k,R,C=i.querySelector(".dt-video-lazy-placeholder");if(C&&i.removeChild(C),"youtube"===E.type||"vimeo"===E.type){(k=document.createElement("div")).className="plyr__video-embed";var z=document.createElement("iframe");if("youtube"===E.type){var $=`https://www.youtube.com/embed/${E.id}?origin=${encodeURIComponent(window.location.origin)}&enablejsapi=1&widgetid=1&modestbranding=1&playsinline=1&showinfo=0&rel=0&iv_load_policy=3&fs=0&autohide=0`;v>0&&($+=`&start=${Math.floor(v)}`),h>0&&($+=`&end=${Math.floor(h)}`),u&&($+="&autoplay=1&mute=1"),z.src=$}else{var S=`https://player.vimeo.com/video/${E.id}?byline=0&portrait=0&title=0`;v>0&&(S+=`#t=${v}s`),u&&(S+="&autoplay=1&muted=1"),z.src=S}z.allowFullscreen=!0,z.allow="autoplay; fullscreen; picture-in-picture",k.appendChild(z),R=z}else{(k=document.createElement("div")).className="plyr__video-wrapper";var I=document.createElement("video");I.className="plyr__video",I.controls=l,I.muted=d,I.loop=p,I.autoplay=u,I.poster=c,I.playbackRate=s,I.playsInline=!0,v>0&&(I.currentTime=v),I.style.position="absolute",I.style.top="0",I.style.left="0",I.style.width="100%",I.style.height="100%",I.style.objectFit="cover",I.style.objectPosition="center";var q=document.createElement("source");q.src=E.id,q.type=function(e){switch(e.split(".").pop().split("?")[0].toLowerCase()){case"mp4":default:return"video/mp4";case"webm":return"video/webm";case"ogg":return"video/ogg";case"mov":return"video/quicktime"}}(E.id),I.appendChild(q),k.appendChild(I),R=I,k.style.width="100%",k.style.height="100%",k.style.position="absolute",k.style.top="0",k.style.left="0"}if(k.style.position="absolute",k.style.top="0",k.style.left="0",k.style.width="100%",k.style.height="100%",k.style.overflow="hidden",i.appendChild(k),c&&!u)(new Image).src=c;var j={controls:w||(l?["play-large","play","progress","current-time","mute","volume","captions","settings","fullscreen"]:[]),muted:d,autoplay:u,loop:{active:p},speed:{selected:s,options:[.5,.75,1,1.25,1.5,1.75,2]},poster:u?null:c,clickToPlay:!u,resetOnEnd:!!p};"youtube"===E.type?j.youtube={noCookie:!1,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,autoplay:u?1:0,start:v>0?Math.floor(v):0,end:h>0?Math.floor(h):void 0}:"vimeo"===E.type&&(j.vimeo={byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,autoplay:u?1:0});var T=new Plyr(k,j);if(n.push({player:T,wrapper:i,referenceImg:r,autoplay:u,videoElement:R,videoType:E.type,startTime:v,endTime:h,quality:b}),T.once("ready",(function(){var e;if(T.speed=s,e=window.getComputedStyle(r).borderRadius,i.querySelectorAll(".plyr, .plyr__video-wrapper, .plyr__video-embed, .plyr--video, .plyr__poster, video").forEach((function(t){t.style.borderRadius=e})),u||L(),P(),("default"!==b&&"youtube"===E.type||"default"!==b&&"vimeo"===E.type)&&(T.quality=b),"video"===E.type&&v>0&&(T.currentTime=v),"video"===E.type&&h>0&&T.on("timeupdate",(function(){T.currentTime>=h&&(p?(T.currentTime=v,T.play()):T.pause())})),"video"===E.type){const e=i.querySelector("video");e&&(e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center")}u?T.play().catch((function(e){console.warn("Autoplay was prevented by browser. Attempting muted autoplay.",e),T.muted=!0,T.play().catch((function(e){console.error("Autoplay was blocked even with muted audio:",e)}))})):(L(),function(){if(c){var e=i.querySelector(".plyr"),t=i.querySelector(".plyr__poster");if(!t||"none"===getComputedStyle(t).backgroundImage){t&&t.parentNode.removeChild(t);var o=document.createElement("div");o.className="plyr__poster custom-poster",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundImage=`url(${c})`,o.style.backgroundSize="cover",o.style.backgroundPosition="center center",o.style.borderRadius=i.style.borderRadius,o.style.zIndex="1",e&&(e.appendChild(o),e.addEventListener("play",(function(){o.style.display="none"})))}}}())})),u&&T.once("playing",(function(){i.classList.add("autoplay-active")})),g){let e;i.addEventListener("mouseenter",(function(){e=setTimeout((()=>{T.play().catch((function(e){T.muted=!0,T.play()}))}),200)})),i.addEventListener("mouseleave",(function(){clearTimeout(e),u||T.pause()}))}f&&document.addEventListener("visibilitychange",(function(){document.hidden?T.pause():u&&T.play()})),T.on("loadedmetadata",P),"video"===E.type&&T.on("ready canplay playing loadeddata",(function(){const e=i.querySelector("video");if(e){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center";const t=i.querySelector(".plyr__video-wrapper");t&&(t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0")}}))}else console.error("Unsupported video URL or could not extract video ID:",a);function P(){if("video"===E.type){const e=i.querySelector("video");return void(e&&(e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center"))}const e=16/9,t=i.offsetWidth,o=i.offsetHeight;if(0===t||0===o)return;const n=t/o;let r;r=n>e?n/e:e/n,i.style.setProperty("--plyr-video-scale",Math.max(1,r));const a=i.querySelector("iframe");a&&(n>e?(a.style.width="100%",a.style.height=100*r+"%"):(a.style.width=100*r+"%",a.style.height="100%"))}function L(){var e=i.querySelector(".plyr__poster");e&&(e.style.backgroundSize="cover",e.style.backgroundPosition="center center",e.style.opacity="1",e.style.width="100%",e.style.height="100%",e.style.borderRadius=i.style.borderRadius,e.style.zIndex="1")}}function l(){n.forEach((function(e){if(e){var t=window.getComputedStyle(e.referenceImg),o=e.wrapper;if(o.style.width=t.width,o.style.height=t.height,o.style.maxWidth=t.maxWidth,o.style.maxHeight=t.maxHeight,o.style.borderRadius=t.borderRadius,t.aspectRatio&&"auto"!==t.aspectRatio&&(o.style.aspectRatio=t.aspectRatio),o.querySelectorAll(".plyr, .plyr__video-wrapper, .plyr__video-embed, .plyr--video, .plyr__poster, .custom-poster, video").forEach((function(e){e.style.borderRadius=t.borderRadius})),!e.autoplay){var n=o.querySelector(".plyr__poster");n&&(n.style.borderRadius=t.borderRadius);var i=o.querySelector(".custom-poster");i&&(i.style.borderRadius=t.borderRadius)}if("video"!==e.videoType){if("youtube"===e.videoType||"vimeo"===e.videoType){const e=16/9,t=o.offsetWidth,n=o.offsetHeight;if(0===t||0===n)return;const i=t/n;let r;r=i>e?i/e:e/i,o.style.setProperty("--plyr-video-scale",Math.max(1,r));const a=o.querySelector("iframe");a&&(i>e?(a.style.width="100%",a.style.height=100*r+"%"):(a.style.width=100*r+"%",a.style.height="100%"))}}else{const e=o.querySelector("video");if(e){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.objectFit="cover",e.style.objectPosition="center";const t=o.querySelector(".plyr__video-wrapper");t&&(t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0")}}}}))}let d;document.querySelectorAll('img[data-dt-video="true"]').forEach((function(t,o){t.getAttribute("data-dt-video-url"),t.getAttribute("data-dt-video-controls"),t.getAttribute("data-dt-video-mute"),parseFloat(t.getAttribute("data-dt-video-playback-rate")),t.getAttribute("data-dt-video-loop");var n=t.getAttribute("src"),i="true"===t.getAttribute("data-dt-video-autoplay"),l=t.getAttribute("data-dt-video-theme-color");t.getAttribute("data-dt-video-custom-controls"),parseFloat(t.getAttribute("data-dt-video-start-time")),parseFloat(t.getAttribute("data-dt-video-end-time")),t.getAttribute("data-dt-video-quality"),t.getAttribute("data-dt-video-pause-on-blur"),t.getAttribute("data-dt-video-play-on-hover");var d="true"===t.getAttribute("data-dt-video-lazy-load"),s=document.createElement("div"),p=t.className;s.className=p+" dt-video-container"+(i?" autoplay-active":""),Array.from(t.attributes).forEach((function(e){"class"===e.name||e.name.startsWith("data-dt-video")||"src"===e.name||"loading"===e.name||"alt"===e.name||s.setAttribute(e.name,e.value)}));var c=t.cloneNode(!0);document.body.appendChild(c),c.style.position="absolute",c.style.opacity="0",c.style.pointerEvents="none",c.style.left="-9999px";var u=window.getComputedStyle(t);if(s.style.width=u.width,s.style.height=u.height,s.style.maxWidth=u.maxWidth,s.style.maxHeight=u.maxHeight,s.style.borderRadius=u.borderRadius,u.aspectRatio&&"auto"!==u.aspectRatio&&(s.style.aspectRatio=u.aspectRatio),d){var y=document.createElement("div");y.className="dt-video-lazy-placeholder",y.style.borderRadius=u.borderRadius,y.style.backgroundImage=`url(${n})`,y.style.backgroundSize="cover",y.style.backgroundPosition="center";var m=document.createElement("div");m.className="lazy-play-button",l&&m.style.setProperty("--plyr-color-main",l),y.appendChild(m),s.appendChild(y),e[o]={img:t,wrapper:s,referenceImg:c},s.dataset.videoIndex=o,y.addEventListener("click",(function(){e[o]&&(a(t,s,c),e[o]=null,r.unobserve(s))})),t.parentNode.replaceChild(s,t),r.observe(s)}else a(t,s,c),t.parentNode.replaceChild(s,t)})),l(),window.addEventListener("resize",(function(){clearTimeout(d),d=setTimeout(l,100)}));[window.matchMedia("(max-width: 991px)"),window.matchMedia("(max-width: 479px)")].forEach((function(e){e.addEventListener("change",l)}))}n="https://cdn.plyr.io/3.7.8/plyr.css",i=function(){var e,t,o;e="https://cdn.plyr.io/3.7.8/plyr.js",t=a,(o=document.createElement("script")).src=e,o.onload=t,document.head.appendChild(o)},(r=document.createElement("link")).rel="stylesheet",r.href=n,r.onload=i||function(){},document.head.appendChild(r)}))}));
